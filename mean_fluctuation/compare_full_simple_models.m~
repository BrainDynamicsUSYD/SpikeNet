
%%%%%%%%%%%% load data here
% load pre-calculated table for (eq 3.4)
table = load('v_CV_tables.mat');
% manually fix some (possibly) numerical errors
table.CV_mat(1:13,1) = 1;
table.CV_mat(end-2:end,1) = 0;
table.v_mat(end-2:end,1) = 0.5;
% something is still wrong here!!!
% transpose for interp2
table.miu_V_mat = table.miu_V_mat';
table.sigma_V_mat = table.sigma_V_mat';
table.CV_mat = table.CV_mat';
table.v_mat = table.v_mat';


% synI{}.I_mean
% popV.V_mean{}
V_mean = R.popV.V_mean{1


%%%%%%%%%%% compare I_mean as output?
for t = 2:step_tot
    mu_V_pre = V_mean(t-1);
    sigma_V_pre =  sqrt(V_std(t-1));
    [ out ] = get_eq3_4_table_lookup(mu_V_pre, sigma_V_pre, table,  'both');
    v_pre = out(1); % fring rate
    CV_pre = out(2); % fring rate CV
    I_mean_tmp = v_pre;
    I_std_tmp = v_pre*CV_pre^2;
end


% compare V_mean time serious?









% solve the mean and CV of first passage time of the O-U process, i.e, (eq 3.4)
